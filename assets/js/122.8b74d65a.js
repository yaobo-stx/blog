(window.webpackJsonp=window.webpackJsonp||[]).push([[122],{498:function(e,a,t){"use strict";t.r(a);var s=t(11),l=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("strong",[e._v("FirewallD")]),e._v(" (firewall daemon) 作为 "),t("strong",[e._v("iptables")]),e._v(" 服务的替代品，已经默认被安装到了 CentOS7 上面。")]),e._v(" "),t("h2",{attrs:{id:"管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理"}},[e._v("#")]),e._v(" 管理")]),e._v(" "),t("h3",{attrs:{id:"服务启动-停止"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务启动-停止"}},[e._v("#")]),e._v(" 服务启动/停止")]),e._v(" "),t("p",[e._v("启动服务并设置自启动：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo systemctl start firewalld\nsudo systemctl enable firewalld\n")])])]),t("p",[e._v("停止服务并禁用自启动：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo systemctl stop firewalld\nsudo systemctl disable firewalld\n")])])]),t("h3",{attrs:{id:"检查运行状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#检查运行状态"}},[e._v("#")]),e._v(" 检查运行状态")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --state\nsudo systemctl status firewalld\n")])])]),t("h3",{attrs:{id:"服务重启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务重启"}},[e._v("#")]),e._v(" 服务重启")]),e._v(" "),t("p",[e._v("有两种办法可以重启 FirewallD：")]),e._v(" "),t("ol",[t("li",[e._v("重启 FirewallD 服务")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo systemctl restart firewalld\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("重载配置文件（不断开现有会话与连接）")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --reload\n")])])]),t("p",[e._v("建议使用第二种方法。")]),e._v(" "),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[e._v("#")]),e._v(" 配置")]),e._v(" "),t("p",[e._v("FirewallD 使用两个配置集：「"),t("strong",[e._v("运行时配置集")]),e._v("」以及「"),t("strong",[e._v("持久配置集")]),e._v("」。")]),e._v(" "),t("ol",[t("li",[e._v("在 FirewallD 运行时：\n"),t("ol",[t("li",[e._v("对运行时配置的更改"),t("strong",[e._v("会")]),e._v("即时生效")]),e._v(" "),t("li",[e._v("对持久配置集的更改"),t("strong",[e._v("不会")]),e._v("被应用到本次运行中")])])]),e._v(" "),t("li",[e._v("在 FirewallD 重启（如系统重启或服务重启）或重载配置时：\n"),t("ol",[t("li",[e._v("运行时配置集的更改"),t("strong",[e._v("不会")]),e._v("被保留")]),e._v(" "),t("li",[e._v("持久配置集的更改"),t("strong",[e._v("会")]),e._v("作为新的运行时配置而应用")])])])]),e._v(" "),t("p",[e._v("默认情况下，使用 "),t("code",[e._v("firewall-cmd")]),e._v(" 命令对防火墙做出的更改都将作用于运行时配置集，但如果添加了 "),t("code",[e._v("permanent")]),e._v(" 参数则可以将改动持久化。如果要将规则同时添加到两个配置集中，有两种方法：")]),e._v(" "),t("ol",[t("li",[e._v("将规则同时添加到两个配置集中")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --zone=public --add-service=http --permanent\nsudo firewall-cmd --zone=public --add-service=http\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("将规则添加到持久配置集中，并重载")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --zone=public --add-service=http --permanent\nsudo firewall-cmd --reload\n")])])]),t("h2",{attrs:{id:"区域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#区域"}},[e._v("#")]),e._v(" 区域")]),e._v(" "),t("p",[e._v("区域（Zone）是 FirewallD 的核心特性，其它所有特性都与 Zone 相关，Zone 可以理解为场景、位置等，我们可以给不同的 Zone 定义不同的规则集。")]),e._v(" "),t("p",[e._v("FirewallD 的默认配置中预定义了几个 Zone，按照可信度作升序排序依次为："),t("code",[e._v("drop")]),e._v(" -> "),t("code",[e._v("block")]),e._v(" -> "),t("code",[e._v("public")]),e._v(" -> "),t("code",[e._v("external")]),e._v(" -> "),t("code",[e._v("dmz")]),e._v(" -> "),t("code",[e._v("work")]),e._v(" -> "),t("code",[e._v("home")]),e._v(" -> "),t("code",[e._v("internal")]),e._v(" -> "),t("code",[e._v("trusted")]),e._v("，其中 "),t("code",[e._v("public")]),e._v(" 是默认值。")]),e._v(" "),t("p",[e._v("相关指令：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# list all zones\nsudo firewall-cmd --get-zones\n\n# get & set default zone\nsudo firewall-cmd --get-default-zone\nsudo firewall-cmd --set-default-zone=external\n\n# interfaces\nsudo firewall-cmd --zone=public --add-interface=wlp1s0\nsudo firewall-cmd --zone=public --change-interface=wlp1s0\n\n# get a list of all active zones\nsudo firewall-cmd --get-active-zones\n\n# print information about a zone\nsudo firewall-cmd --info-zone public\n")])])]),t("h2",{attrs:{id:"端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#端口"}},[e._v("#")]),e._v(" 端口")]),e._v(" "),t("p",[e._v("使用 "),t("code",[e._v("--add-port")]),e._v(" 参数来打开一个端口以及指定它的协议，zone 如果不指定的话则为当前的默认值。例如，通过以下命令来允许 HTTP 以及 HTTPS 协议的网络流量进入：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --zone=public --permanent --add-port=80/tcp --add-port=443\nsudo firewall-cmd --reload\n")])])]),t("p",[e._v("通过 info 指令可以查看刚才添加的端口：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --info-zone public\n")])])]),t("p",[e._v("使用 "),t("code",[e._v("--remove-port")]),e._v(" 参数来阻止或关闭一个端口：")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("sudo firewall-cmd --zone=public --permanent --remove-port=80/tcp --remove-port=443/tcp\n")])])]),t("h2",{attrs:{id:"服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#服务"}},[e._v("#")]),e._v(" 服务")]),e._v(" "),t("p",[e._v("使用 "),t("code",[e._v("--add-service")]),e._v(" 以及 "),t("code",[e._v("--remove-service")]),e._v(" 来启用、禁用服务。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# enable\nsudo firewall-cmd --zone=public --permanent --add-service=http \nsudo firewall-cmd --reload \n\n# disable\nsudo firewall-cmd --zone=public --permanent --remove-service=http \nsudo firewall-cmd --reload \n")])])]),t("h2",{attrs:{id:"端口转发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#端口转发"}},[e._v("#")]),e._v(" 端口转发")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('# 启用 ip masquerade\nsudo firewall-cmd --zone=public --add-masquerade\n\n# 在同一台服务器上将 80 端口的流量转发到 8080 端口\nsudo firewall-cmd --zone="public" --add-forward-port=port=80:proto=tcp:toport=8080\n\n# 将本地的 80 端口的流量转发到 IP 地址为 ：1.2.3.4 的远程服务器上的 8080 端口\nsudo firewall-cmd --zone="public" --add-forward-port=port=80:proto=tcp:toport=8080:toaddr=1.2.3.4\n\n# 删除规则\nsudo firewall-cmd --zone=public --remove-masquerade\n')])])])])}),[],!1,null,null,null);a.default=l.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{447:function(t,s,a){"use strict";a.r(s);var e=a(11),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("在 D3 的使用过程中，我们见得最多的应当是类似如下的代码：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" div "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" d3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'body'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("selectAll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("enter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("append")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" d"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("将得到：")]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("3"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("6"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("9"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("12"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("15"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[t._v("光看代码完全不能理解 D3 到底做了些什么，其实这里关键是 "),a("code",[t._v("enter")]),t._v(" 的使用。")]),t._v(" "),a("h2",{attrs:{id:"overall"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#overall"}},[t._v("#")]),t._v(" Overall")]),t._v(" "),a("p",[a("code",[t._v("enter")]),t._v(" 其实是一个选择集（selection），与其对应的还有 "),a("code",[t._v("update")]),t._v(" 与 "),a("code",[t._v("exit")]),t._v("，选择集中的元素由原始选择集与绑定的数据决定。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://static.wxsm.space/blog/48595775-3ac02200-e991-11e8-8a46-6f8ede2f504d.png",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"selection-enter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#selection-enter"}},[t._v("#")]),t._v(" selection.enter")]),t._v(" "),a("blockquote",[a("p",[t._v("Returns the enter selection: placeholder nodes for each datum that had no corresponding DOM element in the selection. The enter selection is determined by selection.data, and is empty on a selection that is not joined to data.")]),t._v(" "),a("p",[t._v("The enter selection is typically used to create “missing” elements corresponding to new data.")])]),t._v(" "),a("p",[t._v("简述就是，"),a("code",[t._v("enter")]),t._v(" 会根据现有 selection 与绑定的数据量，自动“补齐”所缺失的元素。")]),t._v(" "),a("p",[t._v("比如，例子中，如果 "),a("code",[t._v(".selectAll('p')")]),t._v(" 返回的 selection 中包含 3 个元素，那么因为 data 的长度为 5，"),a("code",[t._v("enter")]),t._v(" 就会补齐缺失的 2 个元素，并返回包含这三个补齐元素的 selection，接下来的操作，就是针对这个 selection 进行的。")]),t._v(" "),a("p",[t._v("因此，在进行 "),a("code",[t._v("enter")]),t._v(" 操作时，一般会事先把相关现有元素尽数清除，以免出现漏操作的情况。")]),t._v(" "),a("p",[t._v("至于再对 "),a("code",[t._v("enter")]),t._v(" 选择集进行 "),a("code",[t._v("append")]),t._v(" 操作时为什么会追加到 body 节点上去，这里就涉及到另一个概念："),a("code",[t._v("selection.update")])]),t._v(" "),a("h2",{attrs:{id:"selection-update"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#selection-update"}},[t._v("#")]),t._v(" selection.update")]),t._v(" "),a("p",[t._v("理解了 "),a("code",[t._v("enter")]),t._v("，"),a("code",[t._v("update")]),t._v(" 就很简单了，顾名思义，所指就是已有的，能够与绑定 data 一一对应上的元素的选择集。")]),t._v(" "),a("p",[t._v("因此，实际上并没有 "),a("code",[t._v("selection.update")]),t._v(" 这个方法，因为没有必要，当前选到的就是 "),a("code",[t._v("update")]),t._v(" 集了。")]),t._v(" "),a("p",[t._v("至于为什么例子中的 "),a("code",[t._v("enter")]),t._v(" 集能够追加到 "),a("code",[t._v("body")]),t._v(" 中去，根据 D3 文档：")]),t._v(" "),a("blockquote",[a("p",[t._v("If the specified type is a string, appends a new element of this type (tag name) as the last child of each selected element, or the next following sibling in the update selection if this is an enter selection.")])]),t._v(" "),a("p",[t._v("当进行 "),a("code",[t._v("selection.append")]),t._v(" 操作时，如果 selection 是一个 "),a("code",[t._v("enter")]),t._v(" 集，那么 "),a("code",[t._v("append")]),t._v(" 就会向相应 "),a("code",[t._v("update")]),t._v(" 集的末尾追加。那么，自然，如果 "),a("code",[t._v("update")]),t._v(" 集为空，就会往父元素内追加。")]),t._v(" "),a("h2",{attrs:{id:"selection-exit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#selection-exit"}},[t._v("#")]),t._v(" selection.exit")]),t._v(" "),a("blockquote",[a("p",[t._v("Returns the exit selection: existing DOM elements in the selection for which no new datum was found.")])]),t._v(" "),a("p",[t._v("对于已有 DOM 元素但没有 data 与之绑定的集合，使用 "),a("code",[t._v("selection.exit")]),t._v(" 来获取。")]),t._v(" "),a("p",[t._v("如果集合没有绑定 data，则返回空集合。如果多次调用 "),a("code",[t._v("exit")]),t._v("，之后的 "),a("code",[t._v("exit")]),t._v(" 会返回空集合。")]),t._v(" "),a("p",[t._v("通常，对于 "),a("code",[t._v("exit")]),t._v(" 集的操作，都是 "),a("code",[t._v("remove")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("selection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p")])}),[],!1,null,null,null);s.default=n.exports}}]);